pgf90  -fast -o laplace2d_f90 laplace2d.f90
pgf90  -fast -mp -Minfo -o laplace2d_f90_omp laplace2d.f90
laplace:
     40, Parallel region activated
     42, Parallel region terminated
     45, Memory zero idiom, array assignment replaced by call to pgf90_mzero4
     47, Memory copy idiom, loop replaced by call to __c_mcopy4
         Loop not fused: different loop trip count
         Loop not fused: function call before adjacent loop
         Generated vector simd code for the loop
     48, Loop not fused: dependence chain to sibling loop
         Loop not vectorized: non-stride-1 array reference
         Loop unrolled 2 times
     49, Loop not fused: function call before adjacent loop
         Loop not vectorized: non-stride-1 array reference
         Loop unrolled 2 times
     50, Memory copy idiom, loop replaced by call to __c_mcopy4
     51, Loop not fused: function call before adjacent loop
         Generated vector simd code for the loop
     53, Parallel region activated
     57, Parallel region terminated
     59, Parallel region activated
     63, Parallel region terminated
     67, Loop not vectorized/parallelized: contains call
     69, Parallel region activated
     90, Parallel region terminated
     95, sum reduction inlined
         Loop not fused: function call before adjacent loop
         Generated vector simd code for the loop containing reductions
pgf90  -acc -ta=nvidia:managed -Minfo=accel -o laplace2d_f90_acc_managed laplace2d.f90
laplace:
     71, Generating implicit copyout(anew(1:4094,1:4094))
         Generating implicit copyin(a(0:4095,0:4095))
     72, Loop is parallelizable
     73, Loop is parallelizable
         Generating Tesla code
         72, !$acc loop gang, vector(4) ! blockidx%y threadidx%y
         73, !$acc loop gang, vector(32) ! blockidx%x threadidx%x
         76, Generating implicit reduction(max:error)
pgf90  -acc -ta=nvidia -Minfo=accel -o laplace2d_f90_acc laplace2d.f90
laplace:
     71, Generating implicit copyout(anew(1:4094,1:4094))
         Generating implicit copyin(a(0:4095,0:4095))
     72, Loop is parallelizable
     73, Loop is parallelizable
         Generating Tesla code
         72, !$acc loop gang, vector(4) ! blockidx%y threadidx%y
         73, !$acc loop gang, vector(32) ! blockidx%x threadidx%x
         76, Generating implicit reduction(max:error)
./laplace2d_f90
Jacobi relaxation Calculation: 4096 x 4096 mesh
 completed in     51.280 seconds, in 2421 iteration, sum(A)= 76859.539
./laplace2d_f90_omp
Jacobi relaxation Calculation: 4096 x 4096 mesh
 Number of OMP threads =             1
 completed in     51.463 seconds, in 2421 iteration, sum(A)= 76859.539
 Number of OMP threads =             2
 completed in     27.957 seconds, in 2421 iteration, sum(A)= 76859.539
 Number of OMP threads =             3
 completed in     27.762 seconds, in 2421 iteration, sum(A)= 76859.539
 Number of OMP threads =             4
 completed in     25.945 seconds, in 2421 iteration, sum(A)= 76859.539
 Number of OMP threads =             5
 completed in     22.645 seconds, in 2421 iteration, sum(A)= 76859.539
 Number of OMP threads =             6
 completed in     21.651 seconds, in 2421 iteration, sum(A)= 76859.539
 Number of OMP threads =             7
 completed in     20.903 seconds, in 2421 iteration, sum(A)= 76859.539
 Number of OMP threads =             8
 completed in     22.114 seconds, in 2421 iteration, sum(A)= 76859.539
./laplace2d_f90_acc
Jacobi relaxation Calculation: 4096 x 4096 mesh
 completed in    115.898 seconds, in 2421 iteration, sum(A)= 76576.305
./laplace2d_f90_acc_managed
Jacobi relaxation Calculation: 4096 x 4096 mesh
 completed in    140.541 seconds, in 2421 iteration, sum(A)= 76576.305

